<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Classifier Model to Predict PONV | Grappling with Data</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Classifier Model to Predict PONV" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Detecting Post Operative Nausea and Vomiting before it happens" />
<meta property="og:description" content="Detecting Post Operative Nausea and Vomiting before it happens" />
<link rel="canonical" href="https://brokengrappler.github.io/my-blog/jupyter/2020/09/13/PONV-Predictor.html" />
<meta property="og:url" content="https://brokengrappler.github.io/my-blog/jupyter/2020/09/13/PONV-Predictor.html" />
<meta property="og:site_name" content="Grappling with Data" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-09-13T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://brokengrappler.github.io/my-blog/jupyter/2020/09/13/PONV-Predictor.html","@type":"BlogPosting","headline":"Classifier Model to Predict PONV","dateModified":"2020-09-13T00:00:00-05:00","datePublished":"2020-09-13T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://brokengrappler.github.io/my-blog/jupyter/2020/09/13/PONV-Predictor.html"},"description":"Detecting Post Operative Nausea and Vomiting before it happens","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/my-blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://brokengrappler.github.io/my-blog/feed.xml" title="Grappling with Data" /><link rel="shortcut icon" type="image/x-icon" href="/my-blog/images/favicon.ico"><link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/my-blog/">Grappling with Data</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/my-blog/about/">About Me</a><a class="page-link" href="/my-blog/search/">Search</a><a class="page-link" href="/my-blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Classifier Model to Predict PONV</h1><p class="page-description">Detecting Post Operative Nausea and Vomiting before it happens</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-09-13T00:00:00-05:00" itemprop="datePublished">
        Sep 13, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/my-blog/categories/#jupyter">jupyter</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/brokengrappler/my-blog/tree/master/_notebooks/2020-09-13-PONV Predictor.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/my-blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/brokengrappler/my-blog/master?filepath=_notebooks%2F2020-09-13-PONV+Predictor.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/my-blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/brokengrappler/my-blog/blob/master/_notebooks/2020-09-13-PONV Predictor.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/my-blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Background">Background </a></li>
<li class="toc-entry toc-h2"><a href="#Did-I-just-perform-ETL?">Did I just perform ETL? </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Step-1:-Clean-the-data">Step 1: Clean the data </a></li>
<li class="toc-entry toc-h3"><a href="#Step-2:-Put-it-in-the-cloud">Step 2: Put it in the cloud </a></li>
<li class="toc-entry toc-h3"><a href="#Step-3:-Never-tell-me-the-odds...-from-a-tree">Step 3: Never tell me the odds... from a tree </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Incremental-Gain">Incremental Gain </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Thoughts-or-Inputs?">Thoughts or Inputs? </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-09-13-PONV Predictor.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Background">
<a class="anchor" href="#Background" aria-hidden="true"><span class="octicon octicon-link"></span></a>Background<a class="anchor-link" href="#Background"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"I thought you just finished your first project? What're you stressing about?" my wife asked at dinner. Little did she know that I felt unbelievable pressure to come up with a meaningful topic since I had selected a trivial one for the first of my four bootcamp projects. I tried to play it cool though and casually threw the ball back in her court. "Yeah, I'm thinking ahead to my next project. Is there anything at work where predictive analytics might help?"</p>
<p>My wife, who works in the medical field, started listing off the common medical classification problems you typically see on Kaggle. I was on a different wave length though. Being on a Freakonomics podcast kick, I wanted to solve a problem that was under the radar; something on a smaller scale that people overlooked but if solved, could result in substantial change for the better.</p>
<p>My next question would lead to my project 3 topic. <strong>"Hey, you seem to talk with your patients a lot about nausea. What's that all about?"</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Post Operative Nausea and Vomiting (PONV)</strong> is the phenomenon of nausea, vomiting, or retching experienced by a patient in the postanesthesia care unit (PACU) or within 24 hours following a surgical procedure. The average incidence of PONV after general anesthesia is about 30% in all post-surgical patients but up to 80% in high-risk patients <sup id="fnref-1" class="footnote-ref"><a href="#fn-1">1</a></sup>. Getting a little motion sickness after an operation may not sound like it's a big deal but according to surveys, patients would rather be in pain than deal with nausea. What complicates this even further is nowadays, physicians and hospitals are reimbursed by insurance companies based on patient satisfaction surveys so if a patient gets PONV, it's not only additional resources spent helping patients recover, but also a hit to the hospital's bottom line.</p>
<p><img src="https://prccustomresearch.com/wp-content/uploads/2019/Blog_Images/GettyImages-157418952-1200x627.jpg" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Anesthesiologists are the doctors typically tasked to deal with PONV and many of them use the simplified scoring system in the chart below. Surely there's a way to use more data and make this a more precise scoring system if it's that important.</p>
<p><img src="/my-blog/images/copied_from_nb/../images/PONV/apfel_score.jpg" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Did-I-just-perform-ETL?">
<a class="anchor" href="#Did-I-just-perform-ETL?" aria-hidden="true"><span class="octicon octicon-link"></span></a>Did I just perform ETL?<a class="anchor-link" href="#Did-I-just-perform-ETL?"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-1:-Clean-the-data">
<a class="anchor" href="#Step-1:-Clean-the-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 1: Clean the data<a class="anchor-link" href="#Step-1:-Clean-the-data"> </a>
</h3>
<p>I would've loved to do more healthcare related data science projects but the primary hurdle was accessibility to data. Fortunatley for this subject, I was able to find some raw data that was available from a research paper written by a physician at the University of Sao Paulo <sup id="fnref-2" class="footnote-ref"><a href="#fn-2">2</a></sup>. While I was grateful to have the data, it wasn't the cleanest. There was a lot of information missing and some of it didn't make any sense. Example:</p>
<p><strong>Patient 2</strong><br>
<strong>Smoker?:</strong> No<br>
<strong>Last cigarette?</strong> 2 weeks ago</p>
<p>I had to make judgment calls for cases like this, which was to say that I assumed if a human were to make an error, it'd be in filling out whether they are a smoker or not rather than accidentally filling out that they last smoked a cigarette 2 weeks ago.</p>
<h3 id="Step-2:-Put-it-in-the-cloud">
<a class="anchor" href="#Step-2:-Put-it-in-the-cloud" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 2: Put it in the cloud<a class="anchor-link" href="#Step-2:-Put-it-in-the-cloud"> </a>
</h3>
<p>One of the requirements for the assignment was to set up a SQL database on an AWS EC/2 machine. While I had gotten somewhat comfortable running queries, creating a table consisting of over 60 features as my first table ever was a bit challenging. Of course I had a near meltdown when it finally ran and the output came out like this:
<img src="/my-blog/images/copied_from_nb/../images/IMG_2747.JPG" alt=""></p>
<p>Word to the wise: use SQL clients. It turned out that's just what things look like on CLI.</p>
<p>It was only about two months later that I discovered what I did was a very rudimentary version of ETL.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Step-3:-Never-tell-me-the-odds...-from-a-tree">
<a class="anchor" href="#Step-3:-Never-tell-me-the-odds...-from-a-tree" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 3: Never tell me the odds... from a tree<a class="anchor-link" href="#Step-3:-Never-tell-me-the-odds...-from-a-tree"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Having true probability was an important component so my choices were either Naive Bayes or Logistic Regression in terms of models.</p>
<p>In terms of metrics, I first optimized for ROC/AUC and subsequently tuned to get the best F1. It was important to minimize both false-positives and false-negatives but quantifying which was more important to minimize was difficult.</p>
<ul>
<li>
<strong>False-Positives</strong>: On the surface, it might be easy to say that having more false-positives is the lesser of two evils. Aggressive treatment may require unnecessary use of drugs that counteract nausea but the drugs do come with side effects. There's a value to patient health and trying to quantify it is rarely straight forward.  </li>
<li>
<strong>False-Negatives</strong>: If we're only looking 10 feet ahead of us, figuratively, there's a lot more short term consequences with not handling a high-risk PONV patient appropriately</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Incremental-Gain">
<a class="anchor" href="#Incremental-Gain" aria-hidden="true"><span class="octicon octicon-link"></span></a>Incremental Gain<a class="anchor-link" href="#Incremental-Gain"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although my model performed better for the test population, it was incremental and I would probably have to do some hypothesis testing to be able to explicitly say that the model is a superior substitute.</p>
<p><img src="/my-blog/images/copied_from_nb/../images/test_scores.png" alt=""></p>
<p>The bigger issue though is that the Apfel test is so much simpler and yet it performed just as well. Unless the model can be improved to the point that it is substantively better than something like the Apfel scoring method, it wouldn't make sense for physicians to input values for nearly 5x the features.</p>
<p><img src="/my-blog/images/copied_from_nb/../images/Streamlit_PONV.png" alt="" title="A snapshot of the app I made via StraemLit"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Thoughts-or-Inputs?">
<a class="anchor" href="#Thoughts-or-Inputs?" aria-hidden="true"><span class="octicon octicon-link"></span></a>Thoughts or Inputs?<a class="anchor-link" href="#Thoughts-or-Inputs?"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you have thoughts on how I might change my approach to the PONV problem, I'm all ears!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="footnotes"><p id="fn-1">1. Choi SU. Is postoperative nausea and vomiting still the big "little" problem?. Korean J Anesthesiol. 2016;69(1):1-2. doi:10.4097/kjae.2016.69.1.1<a href="#fnref-1" class="footnote footnotes">↩</a></p></div>
<br>
<div class="footnotes"><p id="fn-2">2. <a href="#fnref-2" class="footnote footnotes">↩</a></p></div>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="brokengrappler/my-blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/my-blog/jupyter/2020/09/13/PONV-Predictor.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/my-blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/my-blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/my-blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Paul Chung&#39;s project portfolio</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/brokengrappler" title="brokengrappler"><svg class="svg-icon grey"><use xlink:href="/my-blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
